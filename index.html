<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>퀴즈 시스템</title>
<style>
body { font-family: Arial; margin: 20px; }
h1 { margin-bottom: 10px; }
select, button { padding: 8px; margin-right: 10px; }
#questionArea { margin-top: 20px; }
.question-card { border: 1px solid #ccc; padding: 10px; margin-bottom: 5px; cursor: pointer; }
.question-card:hover { background: #f0f0f0; }
#answerBox { margin-top: 20px; padding: 10px; border: 1px solid #444; background: #fafafa; }
#nextBtn { margin-top: 10px; padding: 8px 16px; }
.correct { color: green; font-weight: bold; }
.wrong { color: red; font-weight: bold; }
</style>
</head>
<body>

<h1>퀴즈 시스템</h1>

<select id="subjectSelect">
    <option value="">과목 선택</option>
</select>

<select id="themeSelect">
    <option value="">테마 선택</option>
</select>

<div id="questionArea"></div>
<button id="nextBtn">다음 문제</button>
<div id="answerBox"></div>

<script>
// ★★★ 네 GitHub 저장소 경로 (변경됨) ★★★
const jsonURL = "https://kangroo1209-alt.github.io/quizyquiz/output.json";

let quizData = [];
let currentSubject = "";
let currentTheme = "";
let currentAnswers = []; // 다중정답 지원

fetch(jsonURL)
.then(res => res.json())
.then(data => {
    quizData = data;
    renderSubjects();
});

const subjectSelect = document.getElementById("subjectSelect");
const themeSelect   = document.getElementById("themeSelect");
const questionArea  = document.getElementById("questionArea");
const answerBox     = document.getElementById("answerBox");
const nextBtn       = document.getElementById("nextBtn");

function renderSubjects() {
    const subjects = [...new Set(quizData.map(q => q.subject))];
    subjectSelect.innerHTML = 
        '<option value="">과목 선택</option>' + 
        subjects.map(s => `<option value="${s}">${s}</option>`).join("");
}

subjectSelect.addEventListener("change", () => {
    currentSubject = subjectSelect.value;
    renderThemes();
    questionArea.innerHTML = "";
    answerBox.innerHTML = "";
});

function renderThemes() {
    const themes = [...new Set(
        quizData.filter(q => q.subject === currentSubject)
                .map(q => q.theme)
    )];

    themeSelect.innerHTML = 
        '<option value="">테마 선택</option>' + 
        themes.map(t => `<option value="${t}">${t}</option>`).join("");
}

themeSelect.addEventListener("change", () => {
    currentTheme = themeSelect.value;
    renderQuestion();
    answerBox.innerHTML = "";
});

// 문제 랜덤 생성
function renderQuestion() {

    if (!currentSubject || !currentTheme) {
        questionArea.innerHTML = "<p>과목과 테마를 선택하세요.</p>";
        return;
    }

    const filtered = quizData.filter(
        q => q.subject === currentSubject && q.theme === currentTheme
    );

    if (filtered.length === 0) {
        questionArea.innerHTML = "<p>문제가 없습니다.</p>";
        return;
    }

    const randIndex = Math.floor(Math.random() * filtered.length);
    const problem = filtered[randIndex];

    // ★★★ 다중정답 처리 (쉼표로 여러 정답 가능) ★★★
    currentAnswers = problem.answer
        .split(',')
        .map(a => a.trim())
        .filter(a => a.length > 0);

    // ★★★ 보기 생성 (A 방식: 정답 중복 허용) ★★★
    let candidates = filtered.map(q => q.answer);

    // 중복 제거
    candidates = [...new Set(candidates)];

    // 랜덤 섞기
    candidates.sort(() => Math.random() - 0.5);

    // 정답 포함시키고 보기 5개 확보
    let answers = [];

    // 1️⃣ 정답 먼저 넣기
    currentAnswers.forEach(ans => {
        if (!answers.includes(ans)) answers.push(ans);
    });

    // 2️⃣ 오답 추가해서 5개 맞추기
    for (let c of candidates) {
        if (answers.length >= 5) break;
        if (!answers.includes(c)) answers.push(c);
    }

    // 3️⃣ 최종 섞기
    answers.sort(() => Math.random() - 0.5);

    // 출력
    questionArea.inner
